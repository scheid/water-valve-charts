<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Logical Wave Graph</title>

    <link rel="stylesheet" type="text/css" href="main.css">


    <script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="water-valve-chart.js"></script>
    <script type="text/javascript" src="water-valve-chart-2.js"></script>


    <script type="text/javascript">


        var _data1 = ["and",
            ["and", "A", "B"]];

        var _data2 = ["and",
            ["or", "A", "B"]];

        var _data2Alt = ["and",
            ["or", "Condition 1", "Condition 2"],
             ["and", "Condition 3", "Condition 4"],
             ["or", "Condition 5", "Condition 6", "Condition 7"],
             ["and", "Condition 8", "Condition 9", "Condition 10"],
             ["or", "Condition 11", "Condition 12", ["and", "Condition 13", "Condition 14"]]
            ];


        var _data3 = ["and",
            ["or", "A", ["and", "B", "C"]]];


        var _data4 = ["and",
            ["or", "A", "B", ["and", "C", "D", "E"]]];


        var _data4_obj = ["and",
            ["or", {id: 1, label: "Rule 1", ruleResult: true}, {id: 2, label: "Rule 2", ruleResult: true}, ["and", {id: 3, label: "Rule 3", ruleResult: false}, {id: 4, label: "Rule 4", ruleResult: false}, {id: 5, label: "Rule 5", ruleResult: false}]]];


        var _data11 = ["and",
            "A",
            ["and", "B", ["or", "M", "N"], "Z"],
            ["or", "E", [ "and", "P", "Q"], "S"],
            "F",
            ["or", "G", "H", "I"]
        ];

        var _data22 = ["and",
            ["and", "A", "B"],
            ["or", "B", "M", "N", ["and", "Z", "T"]],
            ["and", "C", "D", "E", "P", "Q", "S"],
            "F",
            ["and", "J", "K", ["or", "G", "H", "I"]],
            ["and", ["or", "U", "V"], "W", "X"]
        ];

        var _data32 = ["and",
            ["and", "A"],
            ["or", "B", "N", ["and", "Z", "T"]],
            ["or", ["and", "C", "D"], ["and", "E", "P"], ["and", "Q", "S"], ["and", "SS"], ["and", "QQQ", "SSS"]],
            "F",
            ["and", "J", "K", ["or", "G", "H", "I"]],
            ["and", ["or", "U", "V"], "W", "X"]
        ];

        var _data11_obj = ["and",
            {label: "A", evalResult:true, id:"bdb69c0e-208f-4537-9a9d-5afbf1d13320"},
            ["and", {label:"B", evalResult: true, id:"41749173-aa0c-4e1b-8f2c-13dd221cbaea"}, ["or", {label:"M", evalResult: true, id:"146b453b-43c1-4e63-a5ab-4ae31e766bd5"}, {label:"N", evalResult: false, id:"5e4a1168-9923-4d51-8fc3-a5fe7d41c879"}], {label:"Z", evalResult: true, id:"df683f0b-ad1c-45a3-8559-2801bc0d6276"}],
            ["or", {label:"E", evalResult: true, id:"c056a120-5e3a-4242-95fd-f9eba45d3835"}, [ "and", {label:"P", evalResult: false, id:"0ddb8c4e-b937-4910-b0a2-a137491c324a"}, {label:"Q", evalResult: false, id:"8893957d-699c-46ef-9ad1-7f5e4ff2fe70"}], {label:"S", evalResult: false, id:"ce6d9fda-1f66-4dcb-954a-32278e9fc585"}],
            {label:"F", evalResult: false, id:"a1942056-4f9e-4de8-9823-4976073f4f7c"},
            ["or", {label:"G", evalResult: undefined, id:"d33b885a-38b4-498f-8c22-bb98ab65564a"}, {label:"H", evalResult: undefined, id:"895a9daa-b5e2-4023-8978-554100501382"}, {label:"I", evalResult: undefined, id:"6e47b25f-367f-40d8-bd7a-c7d05e032ff7"}]
        ];



        function init() {

            var statement1 = new WaterValveChart({
                groupSize: 200,
                data: _data1,
                containerSelector: "#container1"
            }).render();

            var statement2 = new WaterValveChart({
                groupSize: 200,
                data: _data2,
                containerSelector: "#container2"
            }).render();


            var statement3 = new WaterValveChart({
                groupSize: 200,
                data: _data3,
                containerSelector: "#container3"
            }).render();

            var statement4 = new WaterValveChart({
                groupSize: 200,
                data: _data4,
                containerSelector: "#container4"
            }).render();


            var statement4_obj = new WaterValveChart({
                highlightExecutionPath: true,
                groupSize: 200,
                data: _data4_obj,
                containerSelector: "#container4_obj",
                labelField: "label",
                evaluationResultField: "ruleResult"
            }).render();



            var statement11 = new WaterValveChart({
                groupSize: 200,
                data: _data11,
                containerSelector: "#container11"
            }).render();

            var statement11_obj = new WaterValveChart({
                highlightExecutionPath: true,
                groupSize: 200,
                data: _data11_obj,
                containerSelector: "#container11_obj",
                labelField: "label"
            }).render();

            var statement11_vertical = new WaterValveChart({
                groupSize: 200,
                data: _data11,
                containerSelector: "#container11_vert",
                graphDirection: "vertical"
            }).render();


            new WaterValveChartAlt({
                groupSize: 400,
                data: _data2Alt,
                containerSelector: "#container1Alt_vert",
                graphDirection: "vertical"}).render();



            document.getElementById("statement3").innerHTML = statement3;
            document.getElementById("statement4").innerHTML = statement4;
            document.getElementById("statement11").innerHTML = statement11;
            document.getElementById("statement11_obj").innerHTML = statement11_obj;
            document.getElementById("statement1a").innerHTML = statement1;
            document.getElementById("data-structure1a").innerHTML = JSON.stringify(_data1, null, 3);
            document.getElementById("statement2a").innerHTML = statement2;
            document.getElementById("data-structure2a").innerHTML = JSON.stringify(_data2, null, 3);
            document.getElementById("statement4a").innerHTML = statement4;
            document.getElementById("data-structure4a").innerHTML = JSON.stringify(_data4, null, 3);
            document.getElementById("data-structure4_obj").innerHTML = JSON.stringify(_data4_obj, null, 3);

        }


    </script>
</head>
<body onload="init()">

<div style="max-width: 900px;">
<h1>Water Valve Chart</h1>

    <p>Water Valve Chart (WVC) visualizes logical relationships, and is capable of representing
        very complex sets of logical statements pictorially.  The flow starts at one
side and progresses across. The flow could also start at the top and progress downward.</p>


    <table>
        <tr>
            <td>
                <div id="container1"></div>
            </td>
            <td>
                <p>This example illustrates the statement <code>A AND B</code>. Using the analogy of water
                    and gates/locks, both A and B must be open (true) in order for the water to
                    flow through. If you keep this water analogy in mind, even the complex graphs are much
                    easier to understand than the same logic represented in more traditional text based methods.</p>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <td>
                <div id="container2"></div>
            </td>
            <td>
                <p>This example illustrates the statement <code>A OR B</code>. Coming into the block, the
                    "water" splits to flow to both the A and B gates. If either A or B is open (true),
                    then the "water" will flow to the other side of the graph.</p>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <td>
                <div id="container3"></div>
            </td>
            <td>
                <p>Getting progressively more complex, this graph represents <code id="statement3"></code>. The
                    flow can either go through A to reach the other side of the graph, or both B and C
                    need to be open in order for the flow to take that route.</p>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <td>
                <div id="container4"></div>
            </td>
            <td>
                <p>Continuing, this represents <code id="statement4"></code>.</p>

            </td>
        </tr>
    </table>


    <table>
        <tr>
            <td>
                <div id="container4_obj"></div>
            </td>
            <td>
                <p>This shows the same graph as above,  with the execution path highlighted.</p>

            </td>
        </tr>
    </table>


    <p>Multiple blocks/groups can be joined together as well, to better represent distinct objects you may be working with:</p>
    <p> <code id="statement11"></code></p>
    <div id="container11"></div>


<p>It is also possible to display evaluation results for each of the nodes, whether each was true or false.
The WVC code does not inherently do this, because its job is to calculate the layout data, not how to display it. With the
code you are writing that uses the WVC data, you can easily create a display as shown below, using
whatever shapes and styles are appropriate for your display.</p>
    <p> <code id="statement11_obj"></code></p>
    <div id="container11_obj"></div>

    <h2>Input Data Structure</h2>
    <p>So, what is the data structure required as input to create these graphs? The structure is a series
    of arrays, with an array representing a 'group' of items. The first element of every array must be
    the operator 'and' or 'or' and all of the items in the array will be connected using that operator.
    One of the array elements can itself be an array, with the same requirement of having the group operator
    as the first element.  Of course some combinations of comparisons are non-sensical and it is left up
    to the developer to use meaningful structures. The component does not perform any 'sanity' checking
    of the input data.</p>

    <p>The outermost array will define the visual groupings. Each element will be treated as an independent group logically and visually.</p>

    <p>The data shown in these examples use simple alpha-numeric characters as the elements. But you can
    use any custom object structure that you wish, and that entire object will be carried through and exposed
    in the calculated data. This would be a necessity in the real world, especially to allow users to
    interact meaningfully with the graph objects.</p>

    <p>There are a few quirks currently. For the outermost array, you should always use "and" as the operator.</p>

    <p>For the statement <code id="statement1a"></code>, the input data structure would be</p>
    <pre id="data-structure1a"></pre>

    <p>For the statement <code id="statement2a"></code>, the input data structure would be</p>
    <pre id="data-structure2a"></pre>

    <p>For the statement <code id="statement4a"></code>, the input data structure would be</p>
    <pre id="data-structure4a"></pre>

    <p>To create diagram xxxx, the following data is used as input:</p>
    <pre id="data-structure4_obj"></pre>

    <p>In addition to the simple characters used in these examples, you could use any type of
        object with any combination of fields, etc. that you wish for each element. The structure below
        shows an expanded structure of the above data.</p>
    <pre id="data-structure11_obj"></pre>


<h2>Vertical Orientation</h2>
<p>The graph can also be oriented vertically, with a simple configuration setting, such that the first node
    is at the top and the flow goes downward.</p>
<div id="container11_vert"></div>
</div>

<h2>Alternate Node Rendering</h2>
<p>This illustrates that the nodes can be anything you wish. The WVC calculatest the coordinates of the various
entities and you can tailor your d3js code to render those coordinates in many different ways.
</p>
<div id="container1Alt_vert"></div>



</body>
</html>